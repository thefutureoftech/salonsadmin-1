{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.OwnerdetailsComponent = void 0;\n\nconst tslib_1 = require(\"tslib\");\n\nconst translate_service_1 = require(\"../../translate/translate.service\");\n\nconst langs_trans = (0, tslib_1.__importStar)(require(\"../../translate/langs.trans\"));\n\nconst forms_1 = require(\"@angular/forms\");\n\nconst user_dbservice_1 = require(\"../../services/user.dbservice\");\n\nconst user_1 = require(\"../../model/user\");\n\nconst angular_1 = require(\"@mobiscroll/angular\");\n\nconst cross_service_1 = require(\"../../services/cross.service\");\n\nconst store_dbservice_1 = require(\"../../services/store.dbservice\");\n\nconst router_1 = require(\"@angular/router\");\n\nconst user_service_1 = require(\"../../services/user.service\");\n\nconst i0 = (0, tslib_1.__importStar)(require(\"@angular/core\"));\nconst i1 = (0, tslib_1.__importStar)(require(\"../../translate/translate.service\"));\nconst i2 = (0, tslib_1.__importStar)(require(\"../../services/user.dbservice\"));\nconst i3 = (0, tslib_1.__importStar)(require(\"../../services/cross.service\"));\nconst i4 = (0, tslib_1.__importStar)(require(\"../../services/store.dbservice\"));\nconst i5 = (0, tslib_1.__importStar)(require(\"@angular/router\"));\nconst i6 = (0, tslib_1.__importStar)(require(\"../../services/user.service\"));\nconst i7 = (0, tslib_1.__importStar)(require(\"@mobiscroll/angular\"));\nconst i8 = (0, tslib_1.__importStar)(require(\"@angular/forms\"));\nconst i9 = (0, tslib_1.__importStar)(require(\"@angular/common\"));\n\nfunction OwnerdetailsComponent_br_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"br\");\n  }\n}\n\nfunction OwnerdetailsComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10)(1, \"p\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r2.continueToCreateText);\n  }\n}\n\nfunction OwnerdetailsComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 11)(1, \"mbsc-input\", 12);\n    i0.ɵɵlistener(\"ngModelChange\", function OwnerdetailsComponent_div_5_Template_mbsc_input_ngModelChange_1_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return ctx_r6.user.name = $event;\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(2, \"mbsc-input\", 13);\n    i0.ɵɵlistener(\"ngModelChange\", function OwnerdetailsComponent_div_5_Template_mbsc_input_ngModelChange_2_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return ctx_r8.user.arabicName = $event;\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"mbsc-input\", 14);\n    i0.ɵɵlistener(\"ngModelChange\", function OwnerdetailsComponent_div_5_Template_mbsc_input_ngModelChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return ctx_r9.user.email = $event;\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"mbsc-input\", 15);\n    i0.ɵɵlistener(\"ngModelChange\", function OwnerdetailsComponent_div_5_Template_mbsc_input_ngModelChange_4_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return ctx_r10.user.phoneNumber = $event;\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"mbsc-checkbox\", 16);\n    i0.ɵɵlistener(\"change\", function OwnerdetailsComponent_div_5_Template_mbsc_checkbox_change_5_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return ctx_r11.isOwnerStaff = !ctx_r11.isOwnerStaff;\n    });\n    i0.ɵɵelementStart(6, \"span\", 17);\n    i0.ɵɵtext(7, \"Owner is a staff?\");\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"placeholder\", ctx_r3.nameText);\n    i0.ɵɵproperty(\"ngModel\", ctx_r3.user.name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngModel\", ctx_r3.user.arabicName);\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"placeholder\", ctx_r3.emailText);\n    i0.ɵɵproperty(\"ngModel\", ctx_r3.user.email);\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"placeholder\", ctx_r3.phoneText);\n    i0.ɵɵproperty(\"ngModel\", ctx_r3.user.phoneNumber);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"value\", ctx_r3.isOwnerStaff);\n  }\n}\n\nfunction OwnerdetailsComponent_mbsc_button_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mbsc-button\", 18);\n    i0.ɵɵtext(1, \"Next\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵpropertyInterpolate(\"label\", ctx_r4.ownerCreatedText);\n  }\n}\n\nfunction OwnerdetailsComponent_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 19)(1, \"i\", 20);\n    i0.ɵɵelement(2, \"img\", 21)(3, \"br\");\n    i0.ɵɵelementStart(4, \"p\", 22);\n    i0.ɵɵtext(5, \"Creating...\");\n    i0.ɵɵelementEnd()()();\n  }\n}\n\nclass OwnerdetailsComponent {\n  constructor(_translate, userdbService, crossService, storedbService, router, activeRoute, userService) {\n    this._translate = _translate;\n    this.userdbService = userdbService;\n    this.crossService = crossService;\n    this.storedbService = storedbService;\n    this.router = router;\n    this.activeRoute = activeRoute;\n    this.userService = userService;\n    this.isOwnerStaff = true;\n    this.formSettings = {\n      theme: 'ios'\n    };\n    this.selectOptions = {\n      theme: 'material',\n      headerText: 'Select',\n      onSet: (event, inst) => {\n        if (!event.valueText) {\n          this.itemSelected = false;\n          return;\n        }\n\n        if (event.valueText.length == 0) {\n          this.itemSelected = false;\n        } else {\n          this.itemSelected = true;\n        }\n      }\n    };\n  }\n\n  ngOnInit() {\n    this.supportedLanguages = [{\n      display: 'English',\n      value: 'en'\n    }, {\n      display: 'Arabic',\n      value: 'ar'\n    }];\n    this.formClearSub = this.crossService.subToFormClearance().subscribe(flag => {\n      console.log('Inside subcription to form clearance');\n      console.log(flag);\n\n      if (flag) {\n        if (this.myForm) {\n          console.log('clearing form');\n          this.myForm.reset();\n          this.ownerCreatedText = null;\n        }\n      }\n    });\n\n    this._translate.use('en');\n\n    this.continueToCreateText = this._translate.instant(langs_trans.CONT_OWNER_CREATE);\n    this.emailText = this._translate.instant(langs_trans.EMAIL_TEXT);\n    this.nameText = this._translate.instant(langs_trans.NAME_TEXT);\n    this.passwordText = this._translate.instant(langs_trans.PASSWORD_TEXT);\n    this.phoneText = this._translate.instant(langs_trans.PHONE_TEXT);\n    this.createOwnerAccountText = this._translate.instant(langs_trans.CREATE_OWNER_ACCOUNT_LBL);\n    this.selectBusinessTypeText = this._translate.instant(langs_trans.SELECT_BUSINESS_TYPE);\n    this.busNameText = this._translate.instant(langs_trans.SELECT_BUSINESS_NAME);\n    this.ownerCreatedText = null;\n    this.initForm();\n  }\n\n  initForm() {\n    this.user = this.userService.getOwner();\n\n    if (!this.user) {\n      this.user = new user_1.User(true);\n    } // mobiscroll.util.datetime.formatDate('yy-mm-dd HH:ii:ss', new Date());\n\n\n    this.user.createdAt = Date.now();\n\n    if (this.userService.isOwnerStaff()) {\n      this.isOwnerStaff = true;\n    }\n\n    console.log('loaded owner details');\n  }\n\n  proceed(form) {\n    this.emailExistSub = this.userdbService.checkIfAlreadyOwner(this.user.email).subscribe(exists => (0, tslib_1.__awaiter)(this, void 0, void 0, function* () {\n      let result = yield exists;\n\n      if (result && result.result) {\n        angular_1.mobiscroll.alert({\n          title: 'Already an Owner',\n          message: 'Email ' + this.user.email + ' already exists as an Owner'\n        });\n      } else {\n        this.userService.setOwner(this.user);\n        this.userService.setOwnerAsSatff(this.isOwnerStaff);\n        this.router.navigate(['businessDetails']);\n      }\n    }));\n  } // createOwner(form: NgForm) {\n  //   this.myForm = form;\n  //   let user: User = new User(true, 'Super Admin');\n  //   user.name = form.value.name;\n  //   user.email = form.value.email;\n  //   user.phoneNumber = form.value.phone;\n  //   user.password = form.value.password;\n  //   user.phoneNumber = form.value.numpad;\n  //   user.emailVerified = false;\n  //   this.spinning = true;\n  //   this.userdbService.createUser(user)\n  //     .then(\n  //     response => {\n  //       if (response['error']) {\n  //         this.spinning = false;\n  //         mobiscroll.alert({\n  //           title: 'Error',\n  //           message: response.error\n  //         });\n  //         return;\n  //       }\n  //       console.log(\"Response from creating user is \" + response.userId);\n  //       this.userdbService.updateProfile(user, response.userId)\n  //         .then((docRef: DocumentReference) => {\n  //           docRef.get().then((docSnapshot: DocumentSnapshot) => {\n  //             console.log(docSnapshot.data().uid);\n  //             console.log('Selected business is ' + this.busTypeData[form.value.busType].text);\n  //             this.storedbService.getbusinessTypes(this.busTypeData[form.value.busType].text)\n  //               .subscribe(businessTypes => {\n  //                 let store = new Store();\n  //                 store.name = form.value.busName;\n  //                 store.busTypeId = businessTypes[0]['id'];\n  //                 this.userdbService.createOwnerStore(store, docSnapshot.data().uid)\n  //                   .then((docRef: DocumentReference) => {\n  //                     docRef.get().then((docSnapshot2: DocumentSnapshot) => {\n  //                       this.userdbService.craeteUserStoreDetails(docSnapshot.data().uid, docSnapshot2.id);\n  //                       this.spinning = false;\n  //                       this.ownerCreatedText = docSnapshot.data().name + ' Created!';\n  //                       mobiscroll.toast({\n  //                         message: this.ownerCreatedText\n  //                       });\n  //                     })\n  //                       .catch((error) => {\n  //                       });\n  //                   });\n  //               });\n  //           })\n  //             .catch((error) => {\n  //               this.ownerCreatedText = null;\n  //             });\n  //         },\n  //         error => {\n  //           console.log(error);\n  //         }\n  //         );\n  //     })\n  // }\n\n\n  ngOnDestroy() {\n    console.log('destroyed owner details');\n    this.formClearSub.unsubscribe();\n\n    if (this.emailExistSub) {\n      this.emailExistSub.unsubscribe();\n    }\n  }\n\n}\n\nexports.OwnerdetailsComponent = OwnerdetailsComponent;\n\nOwnerdetailsComponent.ɵfac = function OwnerdetailsComponent_Factory(t) {\n  return new (t || OwnerdetailsComponent)(i0.ɵɵdirectiveInject(i1.TranslateService), i0.ɵɵdirectiveInject(i2.UserDBService), i0.ɵɵdirectiveInject(i3.CrossService), i0.ɵɵdirectiveInject(i4.StoreDBService), i0.ɵɵdirectiveInject(i5.Router), i0.ɵɵdirectiveInject(i5.ActivatedRoute), i0.ɵɵdirectiveInject(i6.UserService));\n};\n\nOwnerdetailsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: OwnerdetailsComponent,\n  selectors: [[\"app-ownerdetails\"]],\n  decls: 11,\n  vars: 7,\n  consts: [[1, \"md-create-account\", 3, \"options\"], [\"novalidate\", \"\", 3, \"ngSubmit\"], [\"frm\", \"ngForm\"], [4, \"ngIf\"], [\"class\", \"md-cac-title mbsc-padding\", 4, \"ngIf\"], [\"class\", \"md-cac-cont\", 4, \"ngIf\"], [1, \"mbsc-btn-group-justified\"], [\"type\", \"submit\", \"color\", \"dark\", 3, \"disabled\"], [\"type\", \"button\", \"color\", \"dark\", 3, \"label\", 4, \"ngIf\"], [\"class\", \"loader \", 4, \"ngIf\"], [1, \"md-cac-title\", \"mbsc-padding\"], [1, \"md-cac-cont\"], [\"id\", \"name\", \"name\", \"name\", \"type\", \"text\", \"required\", \"\", 3, \"placeholder\", \"ngModel\", \"ngModelChange\"], [\"id\", \"arabicName\", \"name\", \"arabicName\", \"type\", \"text\", \"placeholder\", \"arabic Name\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"id\", \"email\", \"name\", \"email\", \"type\", \"email\", \"email\", \"\", 3, \"placeholder\", \"ngModel\", \"ngModelChange\"], [\"type\", \"number\", \"id\", \"phoneNumber\", \"name\", \"phoneNumber\", \"required\", \"\", 3, \"placeholder\", \"ngModel\", \"ngModelChange\"], [\"name\", \"ownerStaff\", \"id\", \"ownerStaff\", 3, \"value\", \"change\"], [1, \"mbsc-desc\"], [\"type\", \"button\", \"color\", \"dark\", 3, \"label\"], [1, \"loader\"], [1, \"fa\", \"fa-5x\", 2, \"position\", \"absolute\", \"top\", \"25%\", \"left\", \"50%\"], [\"src\", \"/assets/126.gif\"], [2, \"font-size\", \"20px\", \"color\", \"rgb(7, 6, 6)\", \"font-style\", \"bold\"]],\n  template: function OwnerdetailsComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      const _r12 = i0.ɵɵgetCurrentView();\n\n      i0.ɵɵelementStart(0, \"mbsc-form\", 0)(1, \"form\", 1, 2);\n      i0.ɵɵlistener(\"ngSubmit\", function OwnerdetailsComponent_Template_form_ngSubmit_1_listener() {\n        i0.ɵɵrestoreView(_r12);\n\n        const _r0 = i0.ɵɵreference(2);\n\n        return ctx.proceed(_r0);\n      });\n      i0.ɵɵtemplate(3, OwnerdetailsComponent_br_3_Template, 1, 0, \"br\", 3);\n      i0.ɵɵtemplate(4, OwnerdetailsComponent_div_4_Template, 3, 1, \"div\", 4);\n      i0.ɵɵtemplate(5, OwnerdetailsComponent_div_5_Template, 8, 8, \"div\", 5);\n      i0.ɵɵelementStart(6, \"div\", 6)(7, \"mbsc-button\", 7);\n      i0.ɵɵtext(8, \"Next\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(9, OwnerdetailsComponent_mbsc_button_9_Template, 2, 1, \"mbsc-button\", 8);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵtemplate(10, OwnerdetailsComponent_div_10_Template, 6, 0, \"div\", 9);\n    }\n\n    if (rf & 2) {\n      const _r0 = i0.ɵɵreference(2);\n\n      i0.ɵɵproperty(\"options\", ctx.formSettings);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngIf\", !ctx.ownerCreatedText);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.ownerCreatedText);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.ownerCreatedText);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"disabled\", _r0.invalid && (_r0.dirty || _r0.touched));\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.ownerCreatedText);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.spinning);\n    }\n  },\n  directives: [i7.MbscForm, i8.ɵNgNoValidate, i8.NgControlStatusGroup, i8.NgForm, i9.NgIf, i7.MbscInput, i8.RequiredValidator, i8.NgControlStatus, i8.NgModel, i8.EmailValidator, i7.MbscCheckbox, i7.MbscButton],\n  styles: [\".md-create-account[_ngcontent-%COMP%]{padding:0!important}.md-create-account[_ngcontent-%COMP%]   .md-cac-title[_ngcontent-%COMP%]{text-align:center;padding-bottom:3em}.md-create-account[_ngcontent-%COMP%]   .md-cac-title[_ngcontent-%COMP%], .md-create-account[_ngcontent-%COMP%]   .md-cac-cont[_ngcontent-%COMP%]{padding-top:0}.md-create-account[_ngcontent-%COMP%]   .md-cac-cont[_ngcontent-%COMP%]{padding:0;margin:0}.md-create-account[_ngcontent-%COMP%]   .md-chart-pic[_ngcontent-%COMP%]{background-image:url(/content/img/demos/chart@1x.png);height:150px;background-repeat:no-repeat;background-position:center}@media (-webkit-min-device-pixel-ratio: 2),(-webkit-min-device-pixel-ratio: 1.5),(min-resolution: 144dpi){.md-create-account[_ngcontent-%COMP%]   .md-chart-pic[_ngcontent-%COMP%]{background:url(/Content/img/demos/chart@2x.png) no-repeat center 12px;background-size:109px 81px;background-position:center}}.md-phone-num[_ngcontent-%COMP%]   .mbsc-np-dsp[_ngcontent-%COMP%]{min-height:25px;box-sizing:content-box}.loading-image[_ngcontent-%COMP%]{display:block;margin:0 auto}body[_ngcontent-%COMP%]   .ui-widget-overlay[_ngcontent-%COMP%]{background-color:#42424200}.loader[_ngcontent-%COMP%]{position:fixed;display:block;z-index:1009;background-color:#42424200;opacity:.7;top:0;left:0;width:100%;height:100%;border:3px solid rgb(247,243,243)}\"]\n});","map":null,"metadata":{},"sourceType":"script"}